<%-
  include('layout', {
    title: 'Login',
    body: `
      <div class="row justify-content-center">
        <div class="col-md-5">
          <div class="card shadow-sm">
            <div class="card-body">
              <h3 class="card-title mb-3 text-center">Login</h3>
              <div id="alert" class="alert d-none" role="alert"></div>
              <form id="loginForm">
                <div class="mb-3">
                  <label class="form-label">Email</label>
                  <input type="email" class="form-control" name="email" required />
                </div>
                <div class="mb-3">
                  <label class="form-label">Password</label>
                  <input type="password" class="form-control" name="password" required />
                </div>
                <button type="submit" class="btn btn-primary w-100">Login</button>
              </form>
              <p class="mt-3 text-center">
                Don't have an account?
                <a href="/register">Register</a>
              </p>
            </div>
          </div>
        </div>
      </div>

      <script>
        const form = document.getElementById('loginForm');
        const alertBox = document.getElementById('alert');

        form.addEventListener('submit', async (e) => {
          e.preventDefault();
          alertBox.className = 'alert d-none';
          const formData = new FormData(form);
          const payload = {
            email: formData.get('email'),
            password: formData.get('password'),
          };

          try {
            const res = await fetch('/api/auth/login', {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify(payload),
            });
            const data = await res.json();
            if (!res.ok || !data.success) {
              throw new Error(data.message || 'Login failed');
            }

            localStorage.setItem('token', data.token);
            window.location.href = '/dashboard';
          } catch (err) {
            alertBox.textContent = err.message;
            alertBox.className = 'alert alert-danger';
          }
        });
      </script>
    `,
  });
%>


