<%-
  include('layout', {
    title: 'Register',
    body: `
      <div class="row justify-content-center">
        <div class="col-md-5">
          <div class="card shadow-sm">
            <div class="card-body">
              <h3 class="card-title mb-3 text-center">Register</h3>
              <div id="alert" class="alert d-none" role="alert"></div>
              <form id="registerForm">
                <div class="mb-3">
                  <label class="form-label">Name</label>
                  <input type="text" class="form-control" name="name" required />
                </div>
                <div class="mb-3">
                  <label class="form-label">Email</label>
                  <input type="email" class="form-control" name="email" required />
                </div>
                <div class="mb-3">
                  <label class="form-label">Password</label>
                  <input type="password" class="form-control" name="password" required />
                </div>
                <button type="submit" class="btn btn-success w-100">Register</button>
              </form>
              <p class="mt-3 text-center">
                Already have an account?
                <a href="/login">Login</a>
              </p>
            </div>
          </div>
        </div>
      </div>

      <script>
        const form = document.getElementById('registerForm');
        const alertBox = document.getElementById('alert');

        form.addEventListener('submit', async (e) => {
          e.preventDefault();
          alertBox.className = 'alert d-none';
          const formData = new FormData(form);
          const payload = {
            name: formData.get('name'),
            email: formData.get('email'),
            password: formData.get('password'),
          };

          try {
            const res = await fetch('/api/auth/register', {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify(payload),
            });
            const data = await res.json();
            if (!res.ok || !data.success) {
              throw new Error(data.message || 'Registration failed');
            }

            alertBox.textContent = 'Registered! Redirecting to login...';
            alertBox.className = 'alert alert-success';
            setTimeout(() => {
              window.location.href = '/login';
            }, 1000);
          } catch (err) {
            alertBox.textContent = err.message;
            alertBox.className = 'alert alert-danger';
          }
        });
      </script>
    `,
  });
%>


